/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.5.1/samples
 */
subprojects {

    // Declare where to find the dependencies of the project

    repositories {

        // Use maven for resolving dependencies.

        mavenCentral()

        // this is where identityiq.jar lives

        mavenLocal()

    }

}

ext {

    zipName = "${pluginName}.${version}.zip"

    distDir = "dist"

}

task clean {

    delete "${distDir}"

}

task build(type: Zip, dependsOn: [':ng2page:build',  ':plugin:build']) {

    archiveName "${zipName}"

    destinationDir file("${distDir}")

    into('/') {

        from { project(':plugin').file('build/plugin') }

    }

    into('/ui/ng') {

        from { project(':ng2page').file('dist') }

    }

   

}

task deploy(type: Exec, dependsOn: build) {

    commandLine 'curl',"--insecure", "${distUrl}/rest/plugins", "--form", "file=@${distDir}/${zipName};fileName=${zipName}"

}